---
title: "Operaciones y exploración"
author: "Christian Urcuqui"
date: "17 de enero de 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Operaciones, funciones y gráficos en R

Vamos a utilizar otras funciones y operaciones en R que nos permitan filtrar y hacer operaciones en los datos. A continuación, se muestra una tabla con la lista de operaciones tanto aritméticas como lógicas que se pueden realizar entre los objetos de R.


<img src='https://github.com/urcuqui/Data-Science/blob/master/Utilities/R/operations.png?raw=true' width='250' height='350'>

Hagamos unas operaciones básicas, nosotros podemos utilizar R como una especie de "calculadora"" (muy parecido a la operación entre celdas en Excel). En el siguiente cuadro de código hay unas variables númericas con valores ya asignados con el fin que usted pueda realizar las siguientes operaciones:

+ x + y 
+ x * y 
+ -x
+ sqrt(x)
+ x == y
+ x != y

_Ejercicio 1_

```{R Oexample1}
#Ejecute las siguientes tres líneas de código para crear las variables 
x = c(1, 2, 4, 7, 9, 0)
y = 4
z = c(0.5, 2, 3, 5, 1, 0)

# Escriba en el siguiente espacio la operación suma entre "x" y "y", y asígnelo a resultado_suma (1 línea de código)
resultado_suma <- x + y
# Escriba en el siguiente espacio la operación multiplicación entre "x" y "z", y asígnelo a resultado_multiplicacion (1 línea de código)
resultado_multiplicacion <- x * y
# Escriba en el siguiente espacio la operación multiplicación negativa a "z", y asígnelo a resultado_negativo (1 línea de código)
resultado_negativo <- -z
# Escriba en el siguiente espacio la operación de raíz cuadrada "y", y asígnelo a resultado_raiz (1 línea de código)
resultado_raiz <- sqrt(y)
# Escriba en el siguiente espacio la operación lógica de igualdad entre "x" y "z", y asígnelo a resultado_igualdad (1 línea de código)
resultado_igualdad <- x == z
# Escriba en el siguiente espacio la operación lógica de diferencia entre "x" y "y", y asígnelo a resultado_igualdad (1 línea de código)
resultado_diferencia <- x != y

# --------------------------- #
  
# Ahora ejecute las siguientes líneas de código que le permitirán observar los resultados de sus operaciones.  

print("Resultado Suma")
resultado_suma
print("Resultado multiplicación")
resultado_multiplicacion
print("Resultado negativo")
resultado_negativo
print("Resultado raíz cuadrada")
resultado_raiz
print("Resultado de operación lógica: igualdad")
resultado_igualdad
print("Resultado de operación lógica: diferencia")
resultado_diferencia
```

Ahora, exploremos la función _filter()_, esta función nos permite obtener un subconjunto de un observaciones de un conjunto más grande basado en los parámetros que le suministremos, vea el siguiente ejemplo. 

```
filter(flights,  carrier == "UA")
```

La anterior línea de código nos permite obtener todos los vuelos realizados por una sola aerolínea (para nuestro caso aquella abreviada con "UA").

En la siguiente tabla puede observar la sintaxis para las operaciones lógicas en R.

<img src='https://github.com/urcuqui/Data-Science/blob/master/Utilities/R/logical.png?raw=true' width='250' height='250'>


Nosotros podemos realizar varias operaciones lógicas enlazadas entre sí, por ejemplo:


```
filter(flights,  carrier == "B6" & distance <= 1500)
```

La anterior línea de código nos da los vuelos realizados en el año 2014 y que tuvieron una distancia hasta 1500 millas.

Ahora, le proponemos como ejercicio obtener el subconjunto de datos de los vuelos de la aerolinea "AA" que tuvieron una distancia entre 1300 y 1800 millas.


_Ejercicio 2_

```{R example2}
# Escriba en el siguiente espacio el filtro que permita obtener el subconjunto de vuelos (1 línea de código)
filter(flights, carrier== "AA" & (distance >= 1300 || distance <= 1800))
# --------------------------- #
```

## Gráficos

R es una plataforma muy buena para el desarrollo de visualizaciones.

```{R GExample1}
attach(mtcars)
plot(wt, mpg) # es la función encargada de utilizar el visualizador de R y generar en él un gráfico de dispersión entre las variables cuantitativas
abline(lm(mpg~wt)) # encargada de agregar la línea que mejor se ajusta a los datos de las dos variables
title("Regression of MPG on Weight") # agrega el titulo al plot
```
Ahora procederemos a guardar el plot en un archivo .pdf (previamente visto). 

```{R GExample2}
pdf("mygraph.pdf")
attach(mtcars)
plot(wt, mpg) # es la función encargada de utilizar el visualizador de R y generar en él un gráfico de dispersión entre las variables cuantitativas
abline(lm(mpg~wt)) # encargada de agregar la línea que mejor se ajusta a los datos de las dos variables
title("Regression of MPG on Weight")
dev.off()
```
Es importante tener en cuenta que si vamos a generar distintos insumos podemos utilizar la función ```dev.new()``` con el fin de especificar una nueva visualización y no exista la posibilidad de borrar alguno creado previamente.

Vamos a empezar a explorar la aplicación de visualizaciones en R a través del siguiente ejercicio.

_ Ejercicio 1_

Por favor cree un data frame con los siguientes valores:
```
dose <- c(20, 30, 40, 45, 60)
drugA <- c(16, 20, 27, 40, 60)
drugB <- c(15, 18, 25, 31, 40)
```
```{R exercise1}
# escriba las lineas de código necesarias para crear el data frame con los valores solicitados
dose <- c(20, 30, 40, 45, 60)
drugA <- c(16, 20, 27, 40, 60)
drugB <- c(15, 18, 25, 31, 40)
df <- data.frame(dose, drugA, drugB)
df
# -----------------------------------
```
Ahora veamos cómo crear un simple plot de una línea que relaciona la tendencia de dos variables cuantitativas
```{R GExample3}
plot(df$dose, df$drugA, type="b")
```
La función ```plot()``` es genérica para objetos en R y su salida dependerá del tipo de objeto a ser visualizado. Para el caso anterior podemos ver las variables de la siguiente forma en un plano 'x' y 'y'  ```plot(x, y, type="b") ```, los datos para 'x' iran en el eje horizontal y los de 'y' para el eje vertical. La opción  ```type``` nos indica que tanto los puntos y las lineas deben ser visualizadas. 

_Ejercicio 2_ 

Utilice la ayuda en la función plot y busque la manera de cambiar los títulos de ambos ejes de la anterior visualización.

```{R exercise2}
# 1 linea de código
plot(df$drugB, df$dose, type = "b", xlab = "drug", ylab = "dose")
# --------------------
```
